#Load up the packages (You need to do this every time you start a new R session)
require("ggplot2")
require ("pheatmap")
install.packages("pheatmap")
library(pheatmap)
install.packages("svglite")
library(svglite)
install.packages("grid")
library(grid)

#Import Data
df <- exon_noUTR_42_3113_index_samples_combined_APC_coverage

#For heatmap we just need count data, so we need to tell R we only want that information first
Counts <- data.frame(df$E132.H.001.1_S96_L008_, df$E132.H.002.1_S26_L002_, df$E132.H.004.1_S28_L002_, df$E132.H.005_S21_L002_, df$E132.H.006_S22_L002_, df$E132.H.007_S23_L002_, df$E132.H.008_S24_L002_, df$E132.H.009.1_S29_L002_, df$E132.H.010.1_S101_L008_, df$E132.H.011.1_S102_L008_, df$E132.H.012.1_S103_L008_, df$E132.H.013_S25_L002_, df$E132.H.014_S26_L002_, df$E132.H.015_S27_L002_, df$E132.H.016_S28_L002_, df$E132.H.017.1_S104_L008_, df$E132.H.018.1_S105_L008_, df$E132.H.019_S29_L002_, df$E132.H.020_S30_L002_, df$E218.A.001_S6_L001_, df$NG0921001_EKDN210018941.1A_HN2MGDSX2_L2_, df$NG0921002_EKDN210018942.1A_HN2MGDSX2_L3_, df$NG0921003_EKDN210018943.1A_HN2MGDSX2_L3_, df$NG0921004_EKDN210018944.1A_HMYL3DSX2_L4_,	df$NG0921005_EKDN210018945.1A_HN2MGDSX2_L2_, df$NG0921006_EKDN210018946.1A_HN2MGDSX2_L2_, df$NG0921007_EKDN210018947.1A_HN2MGDSX2_L3_, df$NG0921008_EKDN210018948.1A_HN2MGDSX2_L3_, df$NG0921009_EKDN210018949.1A_HN2MGDSX2_L3_, df$NG0921010_EKDN210018950.1A_HN2MGDSX2_L2_, df$NG0921011_EKDN210018951.1A_HN2MGDSX2_L3_, df$NG0921012_EKDN210018952.1A_HN2MGDSX2_L3_,	df$NG0921013_EKDN210018953.1A_HN2MGDSX2_L2_, df$NG0921014_EKDN210018954.1A_HN2MGDSX2_L3_, df$NG0921015_EKDN210018955.1A_HN2MGDSX2_L3_, df$NG0921016_EKDN210018956.1A_HN2MGDSX2_L2_,	df$NG0921017_EKDN210018957.1A_HN2MGDSX2_L2_, df$NG0921018_EKDN210018958.1A_HN2MGDSX2_L2_, df$NG0921019_EKDN210018959.1A_HN2MGDSX2_L2_, df$NG0921020_EKDN210018960.1A_HN2MGDSX2_L2_,	df$NG0921021_EKDN210018961.1A_HN2MGDSX2_L2_, df$NG0921022_EKDN210018962.1A_HMYL3DSX2_L4_, df$NG0921024_EKDN210018964.1A_HMYL3DSX2_L4_, df$NG0921025_EKDN210018965.1A_HN2MGDSX2_L3_,	df$NG0921026_EKDN210018966.1A_HN2MGDSX2_L2_, df$NG0921027_EKDN210018967.1A_HN2MGDSX2_L3_, df$NG0921028_EKDN210018968.1A_HN2MGDSX2_L3_, df$NG0921029_EKDN210018969.1A_HN2MGDSX2_L3_,	df$NG0921030_EKDN210018970.1A_HN2MGDSX2_L2_, df$NG0921031_EKDN210018971.1A_HN2MGDSX2_L3_, df$NG0921032_EKDN210018972.1A_HN2MGDSX2_L3_, df$NG0921033_EKDN210018973.1A_HN2MGDSX2_L3_, df$NG0921035_EKDN210018974.1A_HMYL3DSX2_L4_, df$X_12M01471_L7_, df$X_12M04992_L6_, df$X_12M10775_L6_, df$X_12M10968_L1_, df$X_12M11537_L6_, df$X_13M01595_L1_, df$X_14M02599_L7_, df$X_14M03641_L1_, df$X_14M06940_L7_,	df$X_14M11145_L7_, df$X_15M00729_L1_, df$X_15M11163_L7_, df$E036.H.002_CGTACTAG.GTAAGGAG_L001_,	df$E036.H.003_AGGCAGAA.GTAAGGAG_L001_, df$E036.H.004_TCCTGAGC.GTAAGGAG_L001_, df$E036.H.005_GGACTCCT.GTAAGGAG_L001_, df$E036.H.006_TAGGCATG.GTAAGGAG_L001_, df$E036.H.009_GCTACGCT.GTAAGGAG_L001_, df$E036.H.011_AAGAGGCA.GTAAGGAG_L001_, df$E036.H.012_GTAGAGGA.GTAAGGAG_L001_, df$E036.H.013_TAAGGCGA.ACTGCATA_L007_, df$E036.H.014_CGTACTAG.ACTGCATA_L007_, df$E036.H.015_AGGCAGAA.ACTGCATA_L007_, df$E036.H.017_GGACTCCT.ACTGCATA_L007_, df$E036.H.018_TAGGCATG.ACTGCATA_L007_, df$E036.H.019_CTCTCTAC.ACTGCATA_L007_, df$E036.H.021_GCTACGCT.ACTGCATA_L007_, df$E036.H.023_AAGAGGCA.ACTGCATA_L007_, df$E036.H.025_GGACTCCT.GTAAGGAG_L007_, df$E036.H.027_CTCTCTAC.GTAAGGAG_L007_, df$E036.H.028_CAGAGAGG.GTAAGGAG_L007_, df$E036.H.029_TAAGGCGA.ACTGCATA_L006_, df$E036.H.030_CGTACTAG.ACTGCATA_L006_, df$E036.H.031_AGGCAGAA.ACTGCATA_L006_, df$E036.H.034_TAGGCATG.ACTGCATA_L006_, df$E036.H.035_CTCTCTAC.ACTGCATA_L006_, df$E036.H.036_CAGAGAGG.ACTGCATA_L006_, df$E036.H.039_CGAGGCTG.ACTGCATA_L006_, df$E036.H.040_TAAGGCGA.GTAAGGAG_L001_, df$E036.H.042_AGGCAGAA.GTAAGGAG_L001_, df$E036.H.043_TCCTGAGC.GTAAGGAG_L001_, df$E036.H.044_GGACTCCT.GTAAGGAG_L001_, df$E036_H_058_L003_, df$E036_H_059_L007_, df$E036_H_062_L003_, df$E036_H_065_L004_, df$E036_H_068_L007_, df$E036_H_070_L005_, df$E036_H_073_L006_, df$E036_H_075_L007_, df$E036_H_076_L006_, df$E036_H_077_L005_, df$E036_H_078_L006 , row.names =df$start)
Counts <- t(Counts)
Counts1 <- as.matrix(Counts)
breaks <- c(1,2,10,50,800)
colors <- c("gray95","grey79","gray62","gray31")

pdf("ALL_Amy_practice_heatmap_exons_allsamples.pdf")

#Plot basic heatmap
pheatmap (Counts1, cluster_rows = F, cluster_cols = F, show_rownames = T, show_colnames = F, breaks=breaks, color=colors, fontsize = 4)
dev.off()
