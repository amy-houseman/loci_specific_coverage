NG0921_bedtools_APC_wholegene_withIDs <- read.delim("~/Desktop/scratch /Complete annotation of VCFs/COVERAGE OF GENES/UCSC - genomic locations/APC loci /NG0921/whole gene coverage/2. combined samples/NG0921_bedtools_APC_wholegene_withIDs.txt")

covData <- NG0921_bedtools_APC_wholegene_withIDs
colnames(covData) <- c("chromosome", "start", "end", "NG0921001_EKDN210018941-1A_HN2MGDSX2_L2_", "NG0921002_EKDN210018942-1A_HN2MGDSX2_L3_", "NG0921003_EKDN210018943-1A_HN2MGDSX2_L3_", "NG0921004_EKDN210018944-1A_HMYL3DSX2_L4_", "NG0921005_EKDN210018945-1A_HN2MGDSX2_L2_", "NG0921006_EKDN210018946-1A_HN2MGDSX2_L2_", "NG0921007_EKDN210018947-1A_HN2MGDSX2_L3_", "NG0921008_EKDN210018948-1A_HN2MGDSX2_L3_", "NG0921009_EKDN210018949-1A_HN2MGDSX2_L3_", "NG0921010_EKDN210018950-1A_HN2MGDSX2_L2_", "NG0921011_EKDN210018951-1A_HN2MGDSX2_L3_", "NG0921012_EKDN210018952-1A_HN2MGDSX2_L3_", "NG0921013_EKDN210018953-1A_HN2MGDSX2_L2_", "NG0921014_EKDN210018954-1A_HN2MGDSX2_L3_", "NG0921015_EKDN210018955-1A_HN2MGDSX2_L3_", "NG0921016_EKDN210018956-1A_HN2MGDSX2_L2_", "NG0921017_EKDN210018957-1A_HN2MGDSX2_L2_", "NG0921018_EKDN210018958-1A_HN2MGDSX2_L2_", "NG0921019_EKDN210018959-1A_HN2MGDSX2_L2_", "NG0921020_EKDN210018960-1A_HN2MGDSX2_L2_", "NG0921021_EKDN210018961-1A_HN2MGDSX2_L2_", "NG0921022_EKDN210018962-1A_HMYL3DSX2_L4_", "NG0921024_EKDN210018964-1A_HMYL3DSX2_L4_", "NG0921025_EKDN210018965-1A_HN2MGDSX2_L3_", "NG0921026_EKDN210018966-1A_HN2MGDSX2_L2_", "NG0921027_EKDN210018967-1A_HN2MGDSX2_L3_", "NG0921028_EKDN210018968-1A_HN2MGDSX2_L3_", "NG0921029_EKDN210018969-1A_HN2MGDSX2_L3_", "NG0921030_EKDN210018970-1A_HN2MGDSX2_L2_", "NG0921031_EKDN210018971-1A_HN2MGDSX2_L3_", "NG0921032_EKDN210018972-1A_HN2MGDSX2_L3_", "NG0921033_EKDN210018973-1A_HN2MGDSX2_L3_", "NG0921035_EKDN210018974-1A_HMYL3DSX2_L4_")

samples <- c("NG0921001_EKDN210018941-1A_HN2MGDSX2_L2_", "NG0921002_EKDN210018942-1A_HN2MGDSX2_L3_", "NG0921003_EKDN210018943-1A_HN2MGDSX2_L3_", "NG0921004_EKDN210018944-1A_HMYL3DSX2_L4_", "NG0921005_EKDN210018945-1A_HN2MGDSX2_L2_", "NG0921006_EKDN210018946-1A_HN2MGDSX2_L2_", "NG0921007_EKDN210018947-1A_HN2MGDSX2_L3_", "NG0921008_EKDN210018948-1A_HN2MGDSX2_L3_", "NG0921009_EKDN210018949-1A_HN2MGDSX2_L3_", "NG0921010_EKDN210018950-1A_HN2MGDSX2_L2_", "NG0921011_EKDN210018951-1A_HN2MGDSX2_L3_", "NG0921012_EKDN210018952-1A_HN2MGDSX2_L3_", "NG0921013_EKDN210018953-1A_HN2MGDSX2_L2_", "NG0921014_EKDN210018954-1A_HN2MGDSX2_L3_", "NG0921015_EKDN210018955-1A_HN2MGDSX2_L3_", "NG0921016_EKDN210018956-1A_HN2MGDSX2_L2_", "NG0921017_EKDN210018957-1A_HN2MGDSX2_L2_", "NG0921018_EKDN210018958-1A_HN2MGDSX2_L2_", "NG0921019_EKDN210018959-1A_HN2MGDSX2_L2_", "NG0921020_EKDN210018960-1A_HN2MGDSX2_L2_", "NG0921021_EKDN210018961-1A_HN2MGDSX2_L2_", "NG0921022_EKDN210018962-1A_HMYL3DSX2_L4_", "NG0921024_EKDN210018964-1A_HMYL3DSX2_L4_", "NG0921025_EKDN210018965-1A_HN2MGDSX2_L3_", "NG0921026_EKDN210018966-1A_HN2MGDSX2_L2_", "NG0921027_EKDN210018967-1A_HN2MGDSX2_L3_", "NG0921028_EKDN210018968-1A_HN2MGDSX2_L3_", "NG0921029_EKDN210018969-1A_HN2MGDSX2_L3_", "NG0921030_EKDN210018970-1A_HN2MGDSX2_L2_", "NG0921031_EKDN210018971-1A_HN2MGDSX2_L3_", "NG0921032_EKDN210018972-1A_HN2MGDSX2_L3_", "NG0921033_EKDN210018973-1A_HN2MGDSX2_L3_", "NG0921035_EKDN210018974-1A_HMYL3DSX2_L4_")

a <- function(x, y){
  col_names <- c("chromosome", "end", x)
  y <- y[,col_names]
  colnames(y) <- c("chromosome", "end", "cov")
  return(y)
}
covData <- lapply(samples, a, covData)

if (!require("BiocManager", quietly = TRUE))
  install.packages("BiocManager")
BiocManager::install(version = "3.15")

BiocManager::install("BSgenome", version = "3.15")

library("BSgenome")
available.genomes()

BiocManager::install("BSgenome.Hsapiens.UCSC.hg38", version = "3.15")
library("BSgenome.Hsapiens.UCSC.hg38")

genomeObject <- BSgenome.Hsapiens.UCSC.hg38

if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("TxDb.Hsapiens.UCSC.hg38.knownGene", version = "3.15")
library("TxDb.Hsapiens.UCSC.hg38.knownGene")
TxDbObject <- TxDb.Hsapiens.UCSC.hg38.knownGene

chromosome <- as.character(unique(covData[[1]]$chromosome))
start <- as.numeric(min(covData[[1]]$end))
end <- as.numeric(max(covData[[1]]$end))
grObject <- GRanges(seqnames=c("chr5"), ranges=IRanges(start=start, end=end))

install.packages("devtools")
if (!require("BiocManager", quietly = TRUE))
  install.packages("BiocManager")

BiocManager::install("GenVisR")

library("GenVisR")
browseVignettes("GenVisR")
genCov(x=covData, txdb=TxDbObject, gr=grObject, genome=genomeObject, cov_plotType="line")
